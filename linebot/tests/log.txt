[dotenv@17.2.1] injecting env (0) from .env -- tip: ‚öôÔ∏è  load multiple .env files with { path: ['.env.local', '.env'] }
[dotenv@17.2.1] injecting env (0) from .env -- tip: üì° observe env with Radar: https://dotenvx.com/radar
MongoDB conectado!
Servidor rodando em http://localhost:8080
[ROTA] /initSuport
Contato recebido: { name: 'Raerio', number: '558498332658@c.us' }
Suporte iniciado: {
  currentProduct: {
    productType: 'Product',
    product: new ObjectId('6877fc47e38f7051ee0f8956')
  },
  _id: new ObjectId('68a07f99912b4330ecba0024'),
  client: new ObjectId('6882747721372a087f3682bc'),
  contact: '558498332658@c.us',
  startTime: 2025-08-16T12:54:49.459Z,
  endTime: null,
  sessionId: '558498332658@c.us-1755348889460-222',
  order: new ObjectId('68a084e6dea212d1f67793af'),
  status: 'in_progress',
  createdAt: 2025-08-16T12:54:49.462Z,
  updatedAt: 2025-08-16T13:17:26.317Z,
  __v: 0,
  currentOrcamento: new ObjectId('68a07f9b912b4330ecba002e')
}
[0mPUT /lineBot/initSuport [32m201[0m 14.728 ms - 474[0m
[ROTA] /allProducts
Produtos sal√°veis: [
  {
    group: null,
    _id: new ObjectId('6877fc47e38f7051ee0f8956'),
    name: 'Kit Ber√ßo percal 230 fios',
    price: 98000,
    description: 'Kit com 9 itens personaliz√°veis.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Confeccionado em percal 230 fios, o kit proporciona um toque macio e aconchegante, ideal para o conforto do beb√™. Os acabamentos refinados garantem durabilidade e eleg√¢ncia ao enxoval. O valor informado refere-se √† composi√ß√£o padr√£o, podendo sofrer altera√ß√µes conforme itens forem adicionados ou removidos do kit.',
    img: '/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wgARCAZABLADASIAAhEBAxEB/8QAGgAAAwEBAQEAAAAAAAAAAAAAAAECAwQFBv/EABcBAQEBAQAAAAAAAAAAAAAA',
    createdAt: 2025-07-16T19:23:51.800Z,
    updatedAt: 2025-07-16T19:23:51.800Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('6878fea2390fad565747e3b6'),
    name: 'Kit Ber√ßo percal 400 fios',
    price: 115000,
    description: 'Kit personaliz√°vel, cont√™m 9 itens.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Confeccionado em percal 400 fios 100% algod√£o, esse kit ber√ßo oferece um toque incrivelmente macio e acetinado, ideal para o conforto e a sensibilidade da pele do beb√™. Com uma trama mais fechada e acabamento refinado, o tecido garante durabilidade, frescor e sofistica√ß√£o. Perfeito para quem busca um enxoval elegante, respir√°vel e de alta qualidade.',
    img: '/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wgARCAZABLADASIAAhEBAxEB/8QAGgAAAwEBAQEAAAAAAAAAAAAAAAECAwQFBv/EABcBAQEBAQAAAAAAAAAAAAAA',
    createdAt: 2025-07-17T13:46:10.249Z,
    updatedAt: 2025-07-17T13:46:10.249Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('6878ff2b9337af0e27cbe33f'),
    name: 'Kit Ber√ßo linho',
    price: 115000,
    description: 'Kit personaliz√°vel, cont√™m 9 itens.',
    isActive: true,
    isSalable: true,
    subProducts: [ [Object], [Object] ],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Este kit ber√ßo √© produzido com linho natural de alta qualidade, conhecido por sua textura leve e apar√™ncia nobre. O tecido proporciona um visual r√∫stico e sofisticado ao mesmo tempo, al√©m de excelente respirabilidade. Ideal para compor um enxoval delicado e elegante, o linho garante frescor, conforto e um toque artesanal que valoriza cada detalhe do ambiente do beb√™.',
    img: '/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wgARCAZABLADASIAAhEBAxEB/8QAGgAAAwEBAQEAAAAAAAAAAAAAAAECAwQFBv/EABcBAQEBAQAAAAAAAAAAAAAA',
    createdAt: 2025-07-17T13:48:27.834Z,
    updatedAt: 2025-07-23T18:23:27.888Z,
    __v: 12
  },
  {
    group: null,
    _id: new ObjectId('687fe73b9eae629b57efab57'),
    name: 'Rolo Lateral em Linho',
    price: 15000,
    description: 'Rolo lateral confeccionado em linho natural para compor o kit ber√ßo.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Confeccionado em linho natural, proporciona conforto e seguran√ßa para o beb√™. Material leve e respir√°vel, com acabamento impec√°vel.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:32:11.776Z,
    updatedAt: 2025-07-22T19:32:11.776Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('687fe74a9eae629b57efab59'),
    name: 'Almofada Personalizada em Linho',
    price: 18000,
    description: 'Almofada personaliz√°vel em linho natural.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Almofada decorativa em linho natural, permitindo personaliza√ß√£o com monogramas ou detalhes especiais. Toque suave e elegante.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:32:26.115Z,
    updatedAt: 2025-07-22T19:32:26.115Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('687fe7519eae629b57efab5b'),
    name: 'Almofada Decorativa em Linho',
    price: 12000,
    description: 'Almofada decorativa em linho para complemento do ber√ßo.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Confeccionada em linho natural, adiciona um toque de sofistica√ß√£o ao ambiente. Dispon√≠vel em diversas cores neutras.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:32:33.960Z,
    updatedAt: 2025-07-22T19:32:33.960Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('687fe7599eae629b57efab5d'),
    name: 'Protetor de Cabeceira em Linho',
    price: 20000,
    description: 'Protetor para cabeceira do ber√ßo em linho natural.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Prote√ß√£o acolchoada em linho natural para a cabeceira do ber√ßo, combinando seguran√ßa e estilo.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:32:41.872Z,
    updatedAt: 2025-07-22T19:32:41.872Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('687fe7639eae629b57efab5f'),
    name: 'Protetor de Peseira em Linho',
    price: 20000,
    description: 'Protetor para peseira do ber√ßo em linho natural.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Prote√ß√£o acolchoada em linho natural para a peseira do ber√ßo, garantindo conforto e harmonia visual.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:32:51.862Z,
    updatedAt: 2025-07-22T19:32:51.862Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('687fe76a9eae629b57efab61'),
    name: 'Mosquiteiro em Linho',
    price: 25000,
    description: 'Mosquiteiro elegante confeccionado em linho natural.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Mosquiteiro em linho natural com estrutura delicada, proporcionando prote√ß√£o contra insetos sem perder o charme.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:32:58.964Z,
    updatedAt: 2025-07-22T19:32:58.964Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('687fe7739eae629b57efab63'),
    name: 'Saiote em Linho',
    price: 15000,
    description: 'Saiote decorativo para ber√ßo em linho natural.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Saiote em linho natural que complementa perfeitamente o conjunto do ber√ßo, com drapeados elegantes.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:33:07.693Z,
    updatedAt: 2025-07-22T19:33:07.693Z,
    __v: 0
  },
  {
    group: null,
    _id: new ObjectId('687fe7b69eae629b57efab65'),
    name: 'Colcha em Linho',
    price: 30000,
    description: 'Colcha para ber√ßo em linho natural.',
    isActive: true,
    isSalable: true,
    subProducts: [],
    category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
    compDescription: 'Colcha em linho natural com acabamento impec√°vel, proporcionando conforto t√©rmico e visual sofisticado.',
    img: '[base64 image data]',
    createdAt: 2025-07-22T19:34:14.329Z,
    updatedAt: 2025-07-22T19:34:14.329Z,
    __v: 0
  }
]
Produtos formatados: [
  {
    value: 'Kit Ber√ßo percal 230 fios',
    id: new ObjectId('6877fc47e38f7051ee0f8956')
  },
  {
    value: 'Kit Ber√ßo percal 400 fios',
    id: new ObjectId('6878fea2390fad565747e3b6')
  },
  {
    value: 'Kit Ber√ßo linho',
    id: new ObjectId('6878ff2b9337af0e27cbe33f')
  },
  {
    value: 'Rolo Lateral em Linho',
    id: new ObjectId('687fe73b9eae629b57efab57')
  },
  {
    value: 'Almofada Personalizada em Linho',
    id: new ObjectId('687fe74a9eae629b57efab59')
  },
  {
    value: 'Almofada Decorativa em Linho',
    id: new ObjectId('687fe7519eae629b57efab5b')
  },
  {
    value: 'Protetor de Cabeceira em Linho',
    id: new ObjectId('687fe7599eae629b57efab5d')
  },
  {
    value: 'Protetor de Peseira em Linho',
    id: new ObjectId('687fe7639eae629b57efab5f')
  },
  {
    value: 'Mosquiteiro em Linho',
    id: new ObjectId('687fe76a9eae629b57efab61')
  },
  {
    value: 'Saiote em Linho',
    id: new ObjectId('687fe7739eae629b57efab63')
  },
  {
    value: 'Colcha em Linho',
    id: new ObjectId('687fe7b69eae629b57efab65')
  }
]
[0mPUT /lineBot/allProducts [32m200[0m 11.801 ms - 752[0m
[ROTA] /selectProduct
Produto ID: 6877fc47e38f7051ee0f8956 Contato: { name: 'Raerio', number: '558498332658@c.us' }
Produto selecionado: {
  group: null,
  _id: new ObjectId('6877fc47e38f7051ee0f8956'),
  name: 'Kit Ber√ßo percal 230 fios',
  price: 98000,
  description: 'Kit com 9 itens personaliz√°veis.',
  isActive: true,
  isSalable: true,
  subProducts: [],
  category: new ObjectId('64b2c55a1f8b9f24d7a8f0ab'),
  compDescription: 'Confeccionado em percal 230 fios, o kit proporciona um toque macio e aconchegante, ideal para o conforto do beb√™. Os acabamentos refinados garantem durabilidade e eleg√¢ncia ao enxoval. O valor informado refere-se √† composi√ß√£o padr√£o, podendo sofrer altera√ß√µes conforme itens forem adicionados ou removidos do kit.',
  img: '/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wgARCAZABLADASIAAhEBAxEB/8QAGgAAAwEBAQEAAAAAAAAAAAAAAAECAwQFBv/EABcBAQEBAQAAAAAAAAAAAAAA',
  createdAt: 2025-07-16T19:23:51.800Z,
  updatedAt: 2025-07-16T19:23:51.800Z,
  __v: 0
}
[0mPUT /lineBot/selectProduct [32m200[0m 8.440 ms - 972[0m
[ROTA] /addToOrcamento
Contato: { name: 'Raerio', number: '558498332658@c.us' }
Produto adicionado ao or√ßamento: {
  _id: new ObjectId('68a07f9b912b4330ecba002e'),
  client: new ObjectId('6882747721372a087f3682bc'),
  total: 588000,
  items: [
    {
      itemType: 'Product',
      product: [Object],
      quantity: 6,
      _id: new ObjectId('68a07f9b912b4330ecba0031')
    }
  ],
  createdAt: 2025-08-16T12:54:51.646Z,
  updatedAt: 2025-08-16T13:19:41.694Z,
  __v: 1
}
[0mPUT /lineBot/addToOrcamento [32m200[0m 19.090 ms - 1233[0m
[ROTA] /previewOrder
[0mPUT /lineBot/previewOrder [32m200[0m 7.080 ms - 65[0m
[ROTA] /makeOrder
[0mPUT /lineBot/makeOrder [32m200[0m 23.751 ms - 490[0m
[ROTA] /validateDate
Validating date:  18/08/2025
dateObj:  Moment<2025-08-18T00:00:00-03:00>
Checking full day schedule for date:  2025-08-18
appointments:  []
[0mPUT /lineBot/validateDate [32m200[0m 11.492 ms - 21[0m
[ROTA] /availableTimeSlots
Data recebida: { date: '18/08/2025' }
[0mPUT /lineBot/availableTimeSlots [32m200[0m 4.884 ms - 811[0m
Cliente que agendou: {
  contactInfo: { name: 'Gabriel Henrique', phoneNumber: '558498332658' },
  _id: new ObjectId('6882747721372a087f3682bc'),
  number: '558498332658@c.us',
  orcamentos: [
    new ObjectId('688900ce091b010c6f8a82fe'),
    new ObjectId('688a6052a8921038b70e2ec6')
  ],
  createdAt: 2025-07-24T17:59:19.464Z,
  updatedAt: 2025-08-16T13:19:43.061Z,
  __v: 1,
  orders: [
    new ObjectId('688a6b7b57f0087270a15159'),
    new ObjectId('688a6ca0b4e9a58f8d09f083'),
    new ObjectId('688acedcf5406d6faa277fdb'),
    new ObjectId('688ad017c393e2d81b40926b'),
    new ObjectId('688ad331659b1279e4326dab'),
    new ObjectId('688ad38045d82966273caff3'),
    new ObjectId('688ad446bbd39432b98d3d50'),
    new ObjectId('688ad4cf24e768e2bb521383'),
    new ObjectId('688ad7745d71bfd43c161bb1'),
    new ObjectId('688ad8b5a1ddba1eaffadde9'),
    new ObjectId('688b90ec27b5d24392024bf3'),
    new ObjectId('688b91bddfa95983661cd555'),
    new ObjectId('688b9295ee5aacfa94ffe304'),
    new ObjectId('688b930d60a1b14ca3cb8fd8'),
    new ObjectId('688cbe2b2922d8bee0f6647c'),
    new ObjectId('688cbf88a67883ea1f5a156d'),
    new ObjectId('688cc0f7db3bd80eb9b03073'),
    new ObjectId('688cc36f3cde6e12d822c022'),
    new ObjectId('6896a0061bb703dfbe07fa47'),
    new ObjectId('6896a09a1cf2b030499a2763'),
    new ObjectId('6896a115dd4fc3c5b246d11d'),
    new ObjectId('6896a16db078b55c73d65c35'),
    new ObjectId('6896a1a341b92964016b9614'),
    new ObjectId('6896a1b507a6ad35bebfa9b5'),
    new ObjectId('6896a61bc71faa610e17cce8'),
    new ObjectId('6896a68107ef7205c7157314'),
    new ObjectId('6896a7577804a474ccebb1ea'),
    new ObjectId('6896aa75212c888fb36f5cab'),
    new ObjectId('6896ac66a277a5f6e4a4a807'),
    new ObjectId('6896adbe98d1773b875d45b5'),
    new ObjectId('6896aeb22e03253fab103478'),
    new ObjectId('6896b087ad825fb174c9aaf5'),
    new ObjectId('6896b123812c6b7ebc1a8974'),
    new ObjectId('6896b342e18ef0c582c18483'),
    new ObjectId('6896b4cbad43492b9bba8239'),
    new ObjectId('689740695fbe5d73926e9158'),
    new ObjectId('689741c53f2ca146a2c4cdd4'),
    new ObjectId('6897431598ac89a44f6a8630'),
    new ObjectId('6897436bcb0f806b80dfc404'),
    new ObjectId('689745973dab08fefc8e5448'),
    new ObjectId('68974aaba3b91f1fcbd5e63a'),
    new ObjectId('68974ec6f56ac1b855490ead'),
    new ObjectId('689752f60a1d56d9b27ff484'),
    new ObjectId('689d2f62e2d42190225dbf3f'),
    new ObjectId('689d30c8e2d42190225dbf8c'),
    new ObjectId('689d315ce2d42190225dbfe1'),
    new ObjectId('689d3244e2d42190225dc036'),
    new ObjectId('689d3304e2d42190225dc08b'),
    new ObjectId('689d354a2fe56f5ffaba56b0'),
    new ObjectId('689fb0f040be12444a483fe8'),
    new ObjectId('689fd357700b829f8e0b7a62'),
    new ObjectId('689fd530555d01f4997176ec'),
    new ObjectId('689fd60f52dc0656962f0781'),
    new ObjectId('689fd782ff31a7397f2c2dac'),
    new ObjectId('68a0651528e510c407c88466'),
    new ObjectId('68a0660c8545af1e7e52b864'),
    new ObjectId('68a06774850c3e36fffd176c'),
    new ObjectId('68a06b4f627c3c7137ae6664'),
    new ObjectId('68a06cc9fd48f36443627c54'),
    new ObjectId('68a06f22e12c95f8b4405475'),
    new ObjectId('68a06fa5441cefad5c94f790'),
    new ObjectId('68a07062f051ae80d76ce72e'),
    new ObjectId('68a072afbbfae7906e082273'),
    new ObjectId('68a07f9c912b4330ecba003c'),
    new ObjectId('68a08086142310da869cc0ef'),
    new ObjectId('68a0816b448567ac076e66e0'),
    new ObjectId('68a08213184125c04e18eaa9'),
    new ObjectId('68a084e6dea212d1f67793af'),
    new ObjectId('68a0856fe9aacbc35233d4c9')
  ],
  appointment: new ObjectId('689fb10040be12444a484032'),
  currentSession: '558498332658@c.us-1755348889460-222'
}
Dados da requisi√ß√£o: {
  id: 1755514800000,
  contact: { name: 'Raerio', number: '558498332658@c.us' },
  client: new ObjectId('6882747721372a087f3682bc'),
  title: 'Encontro de Valida√ß√£o',
  description: 'Encontro agendado para definir os detalhes do pedido feito pelo atendimento automatico'
}
slotMoment: Moment<2025-08-18T08:00:00-03:00>
dateStr: 2025-08-18 timeStr: 08:00
[0mPUT /lineBot/selectTime [32m200[0m 4.780 ms - 26[0m
[ROTA] /resumeAppointment
Dados recebidos: {
  id: 1755514800000,
  date: '18/08/2025',
  contact: { name: 'Raerio', number: '558498332658@c.us' }
}
[0mPUT /lineBot/resumeAppointment [31m500[0m 4.140 ms - 33[0m
